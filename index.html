<!doctype html>
<meta charset=utf-8>
<body>
  <style>
  * { box-sizing: border-box }
  #map { width: 960px; }
  .square { width: 15px; height: 15px; float: left; border: 1px solid; }
  .limit_right  { border-right: 2px solid; }
  .limit_left   { border-left: 2px solid; }
  .limit_bottom { border-bottom: 2px solid; }
  .limit_top    { border-top: 2px solid; }
  #plan { width: 960px; height: 300px }
  </style>

  <div id=map></div>
  <br style=clear:both>
  <p>Object:
    <input type=radio name=element value=floor checked id=floor> floor
    <input type=radio name=element value=spike id=spike> spike
  </p>
  <p><button id=gen>GENERATE</button></p>
  <p><textarea id=plan></textarea></p>

  <script>
    const size = 16
    let tab = [];
    let content = '';
    let mousedown = false;

    for (i = 0; i < size*13; i++) {
      tab[i] = [];
      for (j = 0; j < size*4; j++){
        content += '<div class="square'
        if (i%16 == 0)  content += ' limit_top'
        if (i%16 == 15) content += ' limit_bottom'
        if (j%16 == 0)  content += ' limit_left'
        if (j%16 == 15) content += ' limit_right'
        content += '" id=map'+i+'_'+j+' \
          onmousedown=toggle('+i+','+j+',this,false) \
          onmouseover=toggle('+i+','+j+',this,true) style=background:#eee></div>';
      }
    }
    map.innerHTML = content;

    onmousedown=e=>{mousedown = true;}
    onmouseup=e=>{mousedown = false;}

    toggle = (line, column, current, isMouseOver) => {
      if (isMouseOver && !mousedown) return

      if(spike.checked) {
        tab[line][column] = "spike"
        current.style.background = "#e00"
      } else {
        tab[line][column] = "floor"
        current.style.background = "#000"
      }
    }

    gen.onclick = () => {
      var res = ""
      for (i = 0; i < size * 13; i++) {
        for (j = 0; j < size * 4; j++) {
          if (tab[i][j] == "ladder") res += "="
          else if (tab[i][j] == "bumper") res += "o"
          else if (tab[i][j] == "spike") res += "^"
          else if (tab[i][j] == "floor") res += "-"
          else res += " "
        }
        res += '\n'
      }

      plan.value = res
    }
  </script>
</body>
